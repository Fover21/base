{"root":{"data":{"id":"6cb920bb691e","created":1589894182,"text":"Django1.11.4之模型"},"children":[{"data":{"id":"c2uql6rl0uo0","created":1589894570921,"text":"流程梳理","expandState":"expand"},"children":[{"data":{"id":"c2uqldc3hpc0","created":1589894585222,"text":"创建工程","expandState":"expand"},"children":[{"data":{"id":"c2uqlgkd0s80","created":1589894592252,"text":"执行<django-admin startproject project>"},"children":[]}]},{"data":{"id":"c2uqlzogdqo0","created":1589894633858,"text":"创建项目"},"children":[]},{"data":{"id":"c2uqm3n0ywo0","created":1589894642479,"text":"激活项目"},"children":[]},{"data":{"id":"c2uqm54e1xs0","created":1589894645705,"text":"配置数据库","expandState":"collapse"},"children":[{"data":{"id":"c2uqm74uyu00","created":1589894650087,"text":"修改__init__.py文件"},"children":[]},{"data":{"id":"c2uqmhnkti80","created":1589894672987,"text":"修改settings.py文件中的DATABASES"},"children":[]}]},{"data":{"id":"c2uqmo2g1j40","created":1589894686947,"text":"创建模型类","expandState":"collapse"},"children":[{"data":{"id":"c2uqmq41elc0","created":1589894691397,"text":"在项目目录下的models.py文件中"},"children":[]}]},{"data":{"id":"c2uqn4c1j080","created":1589894722356,"text":"生成迁移文件","expandState":"collapse"},"children":[{"data":{"id":"c2uqnqo1auw0","created":1589894770970,"text":"执行<python manage.py makemigrations>"},"children":[]}]},{"data":{"id":"c2uqnamkb3k0","created":1589894736052,"text":"执行迁移","expandState":"collapse"},"children":[{"data":{"id":"c2uqo3zh0e00","created":1589894799960,"text":"执行<python manage.py migrate>"},"children":[]}]},{"data":{"id":"c2uqpodb9b40","created":1589894922696,"text":"配置站点"},"children":[]},{"data":{"id":"c2uqqlxegps0","created":1589894995745,"text":"创建模板目录/项目模板目录"},"children":[]},{"data":{"id":"c2ur2k3kctk0","created":1589895932134,"text":"在settings.py文件中TEMPLATES配置模板路径"},"children":[]},{"data":{"id":"c2ur0rz4j4g0","created":1589895792551,"text":"在project下修改urls.py"},"children":[]},{"data":{"id":"c2ur0vnpcps0","created":1589895800568,"text":"在项目目录下创建urls.py"},"children":[]}]},{"data":{"id":"c2uqlu9nxlc0","created":1589894622080,"text":"定义模型","expandState":"collapse"},"children":[{"data":{"id":"c2ur6qn915c0","created":1589896259842,"text":"Django都各种数据库提供了很好的支持，为这些数据库提供了同意的调用API，可以根据不同的业务需求选择不同的数据库 "},"children":[]},{"data":{"id":"c2ur6xb5lrs0","created":1589896274348,"text":"配置数据库","expandState":"collapse"},"children":[{"data":{"id":"c2ur8cwaci80","created":1589896386641,"text":"修改工程目录下的__init__.py文件"},"children":[]},{"data":{"id":"c2ur7xhi7540","created":1589896353096,"text":"在settings.py文件中修改DATABASES"},"children":[]}]},{"data":{"id":"c2ur97ka2nk0","created":1589896453396,"text":"开发流程","expandState":"collapse"},"children":[{"data":{"id":"c2ur9blkfso0","created":1589896462181,"text":"配置数据库"},"children":[]},{"data":{"id":"c2ur9cqey4o0","created":1589896464650,"text":"定义模型类"},"children":[{"data":{"id":"c2ur9f4oc4g0","created":1589896469866,"text":"一个模型类对应一个数据库中的表"},"children":[]}]},{"data":{"id":"c2ur9lvbi5c0","created":1589896484538,"text":"生成迁移文件"},"children":[{"data":{"id":"c2ur9rhsw7s0","created":1589896496781,"text":"生成数据表"},"children":[]}]},{"data":{"id":"c2ur9t6pnq00","created":1589896500464,"text":"使用模型类进行增删改查(CRUD)"},"children":[]}]},{"data":{"id":"c2urap9okxc0","created":1589896570301,"text":"ORM","background":"#ffc000","expandState":"collapse"},"children":[{"data":{"id":"c2uras67ns00","created":1589896576622,"text":"概括"},"children":[{"data":{"id":"c2urau6ckyo0","created":1589896580983,"text":"对象、关系、映射"},"children":[]},{"data":{"id":"c2urf7lvcv40","created":1589896923677,"text":"Object/Relational Mapping"},"children":[]}]},{"data":{"id":"c2urckmwfko0","created":1589896716945,"text":"图解","expandState":"expand"},"children":[{"data":{"id":"c2urcmgpafs0","created":1589896720924,"text":" ","image":"https://www.wangbase.com/blogimg/asset/201902/bg2019021802.png","imageTitle":"ORM模型","imageSize":{"width":200,"height":102}},"children":[]}]},{"data":{"id":"c2urddo3yqo0","created":1589896780145,"text":"ORM把数据库映射为对象","expandState":"expand"},"children":[{"data":{"id":"c2urejj2mfk0","created":1589896871265,"text":"数据库的表（table） --> 类（class）\n记录（record，行数据）--> 对象（object）\n字段（field）--> 对象的属性（attribute）"},"children":[]}]},{"data":{"id":"c2urffjp0200","created":1589896940959,"text":"任务"},"children":[{"data":{"id":"c2urfhporkw0","created":1589896945675,"text":"根据对象的类型生成表结构"},"children":[]},{"data":{"id":"c2urfkp8i740","created":1589896952178,"text":"将对象、列表的操作转换为SQL语句"},"children":[]},{"data":{"id":"c2urfsje4i80","created":1589896969239,"text":"将SQL语句查询到的结果转换为对象、列表"},"children":[]}]},{"data":{"id":"c2urg2naj8g0","created":1589896991243,"text":"优点"},"children":[{"data":{"id":"c2urg4hxfs80","created":1589896995272,"text":"减轻了开发人员的工作量，不需要面对因数据库的变更而修改代码"},"children":[]}]}]},{"data":{"id":"c2urgwluvrs0","created":1589897056460,"text":"定义属性","expandState":"collapse"},"children":[{"data":{"id":"c2urh3x9hkg0","created":1589897072387,"text":"模型、属性、表、字段间的关系","expandState":"collapse"},"children":[{"data":{"id":"c2urhaluyj40","created":1589897086935,"text":"一个模型类在数据库中对应一张表，在模型类中定义的属性，对应该模型对照表中的一个字段"},"children":[]}]},{"data":{"id":"c2uri4ua5u80","created":1589897152748,"text":"定义属性","expandState":"collapse","priority":null,"background":"#ffff00"},"children":[{"data":{"id":"c2urkhodg200","created":1589897337417,"text":"概述","expandState":"collapse"},"children":[{"data":{"id":"c2uriw21q2w0","created":1589897211990,"text":"·django根据属性的类型确定以下信息","expandState":"expand"},"children":[{"data":{"id":"c2urj64mqcg0","created":1589897233914,"text":"·当前选择的数据库支持字段的类型\n·渲染管理表单时使用的默认html控件\n·在管理站点最低限度的验证"},"children":[]}]},{"data":{"id":"c2urjidhfxc0","created":1589897260571,"text":"·django会为表增加自动增长的主键列，每个模型只能有一个主键列，如果使用选项设置某属性为主键列后，则django不会再生成默认的主键列"},"children":[]},{"data":{"id":"c2urjzh8r1c0","created":1589897297804,"text":"·属性命名限制"},"children":[{"data":{"id":"c2urk6x0kqg0","created":1589897313995,"text":"·遵循标识符规则\n·由于django的查询方式，不允许使用连续的下划线"},"children":[]}]}]},{"data":{"id":"c2urkvdq2r40","created":1589897367248,"text":"库","expandState":"collapse"},"children":[{"data":{"id":"c2urkwn18g80","created":1589897369987,"text":"·定义属性时，需要字段类型，字段类型被定义在django.db.models.fields目录下，为了方便使用，被导入到django.db.models中"},"children":[]},{"data":{"id":"c2url8kqejk0","created":1589897395970,"text":"·使用方式"},"children":[{"data":{"id":"c2urlbm6ksg0","created":1589897402588,"text":"·导入from django.db import models\n·通过models.Field创建字段类型的对象，赋值给属性"},"children":[]}]}]},{"data":{"id":"c2urnv0zqsw0","created":1589897601570,"text":"逻辑删除","expandState":"collapse"},"children":[{"data":{"id":"c2urnwukns00","created":1589897605536,"text":"·对于重要数据都做逻辑删除，不做物理删除，实现方法是定义isDelete属性，类型为BooleanField，默认值为False"},"children":[]}]},{"data":{"id":"c2uroallm200","created":1589897635468,"text":"字段类型","expandState":"expand","background":"#ffff00"},"children":[{"data":{"id":"c2uroqezxcw0","created":1589897669898,"text":"AutoField"},"children":[{"data":{"id":"c2urot5robc0","created":1589897675870,"text":"一个根据实际ID自动增长的IntegerField,通常不指定"},"children":[]},{"data":{"id":"c2urpffi4eg0","created":1589897724348,"text":"一个主键字段将自动添加到模型中"},"children":[]}]},{"data":{"id":"c2urpi0irns0","created":1589897729972,"text":"·CharField（max_length-字符长度）"},"children":[{"data":{"id":"c2urpplapmo0","created":1589897746466,"text":"·字符串，默认的表单样式是TextInput"},"children":[]}]},{"data":{"id":"c2urpsmqb740","created":1589897753083,"text":"·TextField"},"children":[{"data":{"id":"c2urpw2ruio0","created":1589897760583,"text":"·大文本字段，一般超过4000使用，默认的表单控件是Textarea"},"children":[]}]},{"data":{"id":"c2urpzjtq600","created":1589897768145,"text":"·IntegerField"},"children":[{"data":{"id":"c2urq0nn6b40","created":1589897770552,"text":"整数"},"children":[]}]},{"data":{"id":"c2urq6a2tow0","created":1589897782793,"text":"·DecimalField（max_digits=None，decimal_places=None）"},"children":[{"data":{"id":"c2urqa09h200","created":1589897790906,"text":"·使用python的Decimal实例表示的十进制浮点数"},"children":[]},{"data":{"id":"c2urqbqts740","created":1589897794689,"text":"参数说明","expandState":"expand"},"children":[{"data":{"id":"c2urqdsng1k0","created":1589897799153,"text":"·DecimalField.max_digits\n·位数总数"},"children":[]},{"data":{"id":"c2urqiz255s0","created":1589897810425,"text":"·DecimalField.decimal_places\n·小数点后的数字位数"},"children":[]}]}]},{"data":{"id":"c2urtfjtkps0","created":1589898038065,"text":"FloatField"},"children":[{"data":{"id":"c2urtx4wssg0","created":1589898076346,"text":"用Python的float实例来表示的浮点数"},"children":[]}]},{"data":{"id":"c2uru3thrhk0","created":1589898090893,"text":"BooleanField"},"children":[{"data":{"id":"c2uru6ihzbc0","created":1589898096759,"text":"true/false字段，此字段的默认表单控制是CheckboxInput"},"children":[]}]},{"data":{"id":"c2uruuy39n40","created":1589898149944,"text":"·NullBooleanField"},"children":[{"data":{"id":"c2urv3t1c880","created":1589898169230,"text":"支持null、true、false三种值"},"children":[]}]},{"data":{"id":"c2urvg3ozmg0","created":1589898195995,"text":"DateField([auto_now=False，auto_now_add=False]）"},"children":[{"data":{"id":"c2urvj4eqzk0","created":1589898202569,"text":"·使用Python的datetime.date实例表示的日期"},"children":[]},{"data":{"id":"c2urvm36fxk0","created":1589898209025,"text":"·参数说明","expandState":"expand"},"children":[{"data":{"id":"c2urvvujz0o0","created":1589898230271,"text":"·DateField.auto_now\n·每次保存对象时，自动设置该字段为当前时间，用于“最后一次修改”的时间戳，它总是使用当前日期，默认为false·"},"children":[]},{"data":{"id":"c2urw54uqnc0","created":1589898250485,"text":"DateField.auto_now_add\n·当对象第一次被创建时自动设置当前时间，用于创建的时间戳，它总是使用当前日期，默认为false"},"children":[]}]},{"data":{"id":"c2urwlxgii00","created":1589898287043,"text":"说明"},"children":[{"data":{"id":"c2urwo5jdwg0","created":1589898291885,"text":"·该字段默认对应的表单控件是一个TextInput.在管理员站点添加了一个Javascript写的日历控件，和一个“Today”的快捷按钮，包含了一个额外的invalid_date错误消息键"},"children":[]}]},{"data":{"id":"c2urws2o2e80","created":1589898300419,"text":"注意"},"children":[{"data":{"id":"c2urwtowq740","created":1589898303940,"text":"·auto_now_add，auto_now，and default 这些设置是相排斥的，他们之间的任何组合将会发生错误的结果"},"children":[]}]}]},{"data":{"id":"c2us02xfpnk0","created":1589898559140,"text":"TimeField"},"children":[{"data":{"id":"c2us0jq6pew0","created":1589898595707,"text":"使用Python的datetime.time实例表示的时间，参数同DateField"},"children":[]}]},{"data":{"id":"c2us116344g0","created":1589898633673,"text":"DateTimeField"},"children":[{"data":{"id":"c2us15vie4w0","created":1589898643918,"text":"使用Python的datetime，参数同DateField"},"children":[]}]},{"data":{"id":"c2us1agrmig0","created":1589898653910,"text":"FileField"},"children":[{"data":{"id":"c2us1dmlnzs0","created":1589898660793,"text":"一个上传文件的字段"},"children":[]}]},{"data":{"id":"c2us1hk0a740","created":1589898669344,"text":"ImageField"},"children":[{"data":{"id":"c2us1jtzz4g0","created":1589898674301,"text":"继承了FileField的所有属性和方法，但对上传的对象进行校验，确保它是个有效的image"},"children":[]}]}]},{"data":{"id":"c2us24blvnk0","created":1589898718902,"text":"字段选项","expandState":"expand"},"children":[{"data":{"id":"c2us28k9oko0","created":1589898728132,"text":"概述"},"children":[{"data":{"id":"c2us3gcbf680","created":1589898823430,"text":".通过字段选项，可以实现对字段的约束\n·在字段对象时通过关键字参数指定"},"children":[]}]},{"data":{"id":"c2us2a02py80","created":1589898731265,"text":"null"},"children":[{"data":{"id":"c2us3i1nkqg0","created":1589898827139,"text":"·如果为True，Django将空值以NULL存储到数据库中，默认值是False"},"children":[]}]},{"data":{"id":"c2us3nbyvcg0","created":1589898838646,"text":"blank"},"children":[{"data":{"id":"c2us3pz738g0","created":1589898844405,"text":"·如果为True，则该字段允许为空白，默认值是False"},"children":[]}]},{"data":{"id":"c2us3r4h0ug0","created":1589898846900,"text":"·注意"},"children":[{"data":{"id":"c2us3wtm84g0","created":1589898859305,"text":"·null是数据库范畴的概念，blank是表单验证证范畴的"},"children":[]}]},{"data":{"id":"c2us41sxd4o0","created":1589898870147,"text":"·db_column"},"children":[{"data":{"id":"c2us44f132o0","created":1589898875837,"text":".字段的名称，如果未指定，则使用属性的名称"},"children":[]}]},{"data":{"id":"c2us46td3c00","created":1589898881057,"text":"·db_index"},"children":[{"data":{"id":"c2us47rwti80","created":1589898883146,"text":".若值为True，则在表中会为此字段创建索引"},"children":[]}]},{"data":{"id":"c2us4c9md400","created":1589898892924,"text":"·default"},"children":[{"data":{"id":"c2us4etm69s0","created":1589898898487,"text":"·默认值"},"children":[]}]},{"data":{"id":"c2us7djd4740","created":1589899130782,"text":"·primary_key"},"children":[{"data":{"id":"c2us7g1qvnc0","created":1589899136248,"text":"·若为True，则该字段会成为模型的主键字段"},"children":[]}]},{"data":{"id":"c2us7iuat9c0","created":1589899142328,"text":"·unique"},"children":[{"data":{"id":"c2us7lodwew0","created":1589899148500,"text":"·如果为true，这个字段在表中必须有唯一值"},"children":[]}]}]},{"data":{"id":"c2usajh1svk0","created":1589899378796,"text":"关系","expandState":"expand"},"children":[{"data":{"id":"c2usalxr3c00","created":1589899384159,"text":"分类"},"children":[{"data":{"id":"c2usamzs4fs0","created":1589899386459,"text":"·Foreignkey：一对多，将字段定义在多的端中"},"children":[]},{"data":{"id":"c2usatqixgg0","created":1589899401137,"text":"·ManyToManyField：多对多，将字段定义在两端中"},"children":[]},{"data":{"id":"c2usaxr8pcg0","created":1589899409887,"text":"·OneToOneField：一对一，将字段定义在任意一端中"},"children":[]}]},{"data":{"id":"c2usbqp46600","created":1589899472885,"text":"用一访问多"},"children":[{"data":{"id":"c2usbt84p740","created":1589899478388,"text":"格式"},"children":[{"data":{"id":"c2usbzxi9pk0","created":1589899492984,"text":"对象、模型类小写_set"},"children":[]}]},{"data":{"id":"c2usc4e17ts0","created":1589899502691,"text":"示例"},"children":[{"data":{"id":"c2usc6tv9xk0","created":1589899508001,"text":"grade.students_set"},"children":[]}]}]},{"data":{"id":"c2usbqp46600","created":1589899472885,"text":"用一访问一"},"children":[{"data":{"id":"c2usbt84p740","created":1589899478388,"text":"格式"},"children":[{"data":{"id":"c2usbzxi9pk0","created":1589899492984,"text":"对象、模型类小写"},"children":[]}]},{"data":{"id":"c2usc4e17ts0","created":1589899502691,"text":"示例"},"children":[{"data":{"id":"c2usc6tv9xk0","created":1589899508001,"text":"grade.students"},"children":[]}]}]},{"data":{"id":"c2usbqp46600","created":1589899472885,"text":"访问id"},"children":[{"data":{"id":"c2usbt84p740","created":1589899478388,"text":"格式"},"children":[{"data":{"id":"c2usbzxi9pk0","created":1589899492984,"text":"对象.属性_id"},"children":[]}]},{"data":{"id":"c2usc4e17ts0","created":1589899502691,"text":"示例"},"children":[{"data":{"id":"c2usc6tv9xk0","created":1589899508001,"text":"student.sgrade_id"},"children":[]}]}]}]}]}]},{"data":{"id":"c2usdg910uo0","created":1589899606873,"text":"创建模型类"},"children":[]},{"data":{"id":"c2v5kbo8yi00","created":1589936819887,"text":"元选项","expandState":"collapse"},"children":[{"data":{"id":"c2v5kf9530g0","created":1589936827681,"text":"在模型类中定义Meta类，用于设置元信息"},"children":[{"data":{"id":"c2v5moke5u00","created":1589937004681,"text":"db_table"},"children":[{"data":{"id":"c2v5mzs7cog0","created":1589937029097,"text":"定义数据表名，如果不写数据，则数据表明默认为<项目名_类名>"},"children":[]}]},{"data":{"id":"c2v5mqq44nk0","created":1589937009380,"text":"ordering"},"children":[{"data":{"id":"c2v5nyfua0w0","created":1589937104537,"text":"对象的默认排序字段，获取对象的列表时可以使用"},"children":[]},{"data":{"id":"c2v5okcm2wg0","created":1589937152231,"text":"ordering['id']"},"children":[{"data":{"id":"c2v5oo47qhc0","created":1589937160431,"text":"升序"},"children":[]}]},{"data":{"id":"c2v5opm0hy00","created":1589937163684,"text":"ordering['-id']"},"children":[{"data":{"id":"c2v5owab4ow0","created":1589937178213,"text":"降序"},"children":[]}]},{"data":{"id":"c2v5ufrfo3c0","created":1589937612429,"text":"排序会增加数据库的开销"},"children":[]}]}]}]}]},{"data":{"id":"c2v5v9viwjk0","created":1589937677979,"text":"模型成员 ","expandState":"collapse"},"children":[{"data":{"id":"c2v5w1vmr080","created":1589937738936,"text":"类属性","expandState":"collapse"},"children":[{"data":{"id":"c2v6ebmb2ag0","created":1589939170695,"text":"objects查询器","expandState":"collapse"},"children":[{"data":{"id":"c2v6ef9j7ds0","created":1589939178629,"text":"是Manager类型的一个对象，作用是和数据库进行交互","background":"#ffc000"},"children":[]},{"data":{"id":"c2v6l39p04o0","created":1589939701067,"text":"当定义模型类时没有指定管理器，则Django为模型创建一个名为objects的管理器"},"children":[]}]},{"data":{"id":"c2v6llqo2200","created":1589939741275,"text":"自定义管理器","expandState":"expand"},"children":[{"data":{"id":"c2v6ngwngq00","created":1589939887482,"text":"stuObj  = models.Manager()"},"children":[]},{"data":{"id":"c2v6nmkccg80","created":1589939899798,"text":"当为模型指定管理器，Django就不再为模型类生成objects管理器"},"children":[]}]},{"data":{"id":"c2v6o5lxuzk0","created":1589939941254,"text":"自定义管理器Manager类","expandState":"expand"},"children":[{"data":{"id":"c2v6ofh2a6w0","created":1589939962726,"text":"模型管理器是Django的模型与数据库进行交互的接口，一个模型可以有多个模型管理器"},"children":[]},{"data":{"id":"c2v6pa9ukps0","created":1589940029770,"text":"作用"},"children":[{"data":{"id":"c2v6pc9nbuo0","created":1589940034113,"text":"向管理器类中添加额外的方法"},"children":[]},{"data":{"id":"c2v6pjhiwv40","created":1589940049826,"text":"修改管理器返回的原始查询集"},"children":[{"data":{"id":"c2v6qfobeew0","created":1589940119893,"text":"重写get_queryset()方法"},"children":[]}]}]},{"data":{"id":"c2vfepn5rfs0","created":1589964591210,"text":"代码示例","expandState":"expand"},"children":[{"data":{"id":"c2vff3l3bpc0","created":1589964621560,"text":"","image":"https://kityminder-img.gz.bcebos.com/540313bb3793c809001d16b42cb99f215482f881","imageSize":{"width":200,"height":47}},"children":[{"data":{"id":"c32w8eb5usg0","created":1590722974920,"text":"class StudentsManager(models.Manager):"},"children":[{"data":{"id":"c32w8ev3fgw0","created":1590722976126,"text":"def get_queryset(self):"},"children":[{"data":{"id":"c32w8ev46ew0","created":1590722976127,"text":"return super(StudentsManager, self).get_queryset().filter(isDelete=False)"},"children":[]}]}]}]}]}]}]},{"data":{"id":"c2v5w39w5ug0","created":1589937741975,"text":"创建对象","expandState":"collapse"},"children":[{"data":{"id":"c2vfgu0ywm80","created":1589964757481,"text":"目的：向数据库中添加数据"},"children":[]},{"data":{"id":"c2vfno4ptuw0","created":1589965293196,"text":"当创建对象时，Django不会对数据库进行读写操作，当调用save()方法时才与数据库交互，将对象保存到数据库表中"},"children":[]},{"data":{"id":"c2vfo9v2am00","created":1589965340501,"text":"注意：__init__方法已经在父类models.Model中使用，在自定义的模型中无法使用"},"children":[]},{"data":{"id":"c2vfp2e6brc0","created":1589965402607,"text":"方法两种","expandState":"collapse"},"children":[{"data":{"id":"c2vfp3zand40","created":1589965406061,"text":"在模型类中增加一个类方法","expandState":"expand"},"children":[{"data":{"id":"c2vfpl2g8hs0","created":1589965443257,"text":"@classmethod\ndef createStudent(cls, name, age, gender, contend, lastTime, createTime, grade, isDelete=False):\n\tstu = cls(name=name, age=age, gender=gender, contend=contend, lastTime=lastTime, createTime=createTime, grade=grade, isDelete=isDelete)\n\treturn stu","image":"https://kityminder-img.gz.bcebos.com/1f01a728031b21e7834ab9fe4f1cf94049cda395","imageSize":{"width":200,"height":31}},"children":[]},{"data":{"id":"c2vhm2sbhw80","created":1589970810590,"text":"视图中的应用","image":"https://kityminder-img.gz.bcebos.com/f480b26d0fe9c9c978ce9dc40986e1cbb3df9e9e","imageSize":{"width":200,"height":23}},"children":[{"data":{"id":"c32w7rtzee80","created":1590722925993,"text":"def addstudent(request):"},"children":[{"data":{"id":"c32w7slywnc0","created":1590722927685,"text":"grade = Grades.objects.get(pk=1)"},"children":[]},{"data":{"id":"c32w7slzhcg0","created":1590722927686,"text":"stu = Students.createStudent('刘德华', 34, True, 'zzzzz', '2020-5-20', '2020-5-20', grade)"},"children":[]},{"data":{"id":"c32w7slzvfk0","created":1590722927686,"text":"stu.save()"},"children":[]},{"data":{"id":"c32w7sm06mo0","created":1590722927687,"text":"return HttpResponse('success!')"},"children":[]}]}]}]},{"data":{"id":"c2vfp7qcs800","created":1589965414227,"text":"在自定义管理器中添加一个方法","expandState":"collapse"},"children":[{"data":{"id":"c2vi4ahoh6o0","created":1589972237915,"text":"分支主题","image":"https://kityminder-img.gz.bcebos.com/c8a5452dd8c9e4990ae9ae026e17e1ad70307314","imageSize":{"width":200,"height":64}},"children":[{"data":{"id":"c32w81rxh6w0","created":1590722947636,"text":"class StudentsManager(models.Manager):","expandState":"collapse"},"children":[{"data":{"id":"c32w82gfqgw0","created":1590722949118,"text":"def get_queryset(self):"},"children":[{"data":{"id":"c32w82gg3ug0","created":1590722949119,"text":"return super(StudentsManager, self).get_queryset().filter(isDelete=False)"},"children":[]}]},{"data":{"id":"c32w82gguiw0","created":1590722949120,"text":"def createStudent(self, name, age, gender, contend, lastT, createT, grade, isD=False):"},"children":[{"data":{"id":"c32w82ggvqg0","created":1590722949120,"text":"stu = self.model()  # Students类型"},"children":[]},{"data":{"id":"c32w82gh7ds0","created":1590722949121,"text":"stu.name = name"},"children":[]},{"data":{"id":"c32w82ghlug0","created":1590722949121,"text":"stu.age = age"},"children":[]},{"data":{"id":"c32w82ghv0o0","created":1590722949122,"text":"stu.gender = gender"},"children":[]},{"data":{"id":"c32w82gillc0","created":1590722949123,"text":"stu.contend = contend"},"children":[]},{"data":{"id":"c32w82gj7sg0","created":1590722949124,"text":"stu.lastTime = lastT"},"children":[]},{"data":{"id":"c32w82gj2iw0","created":1590722949124,"text":"stu.createTime = createT"},"children":[]},{"data":{"id":"c32w82gjf6w0","created":1590722949124,"text":"stu.grade = grade"},"children":[]},{"data":{"id":"c32w82gjz6g0","created":1590722949125,"text":"return stu"},"children":[]}]}]}]}]}]}]}]},{"data":{"id":"c2vi69hrxs00","created":1589972392473,"text":"模型查询"},"children":[{"data":{"id":"c2vi6bs0nm80","created":1589972397446,"text":"概述","expandState":"collapse"},"children":[{"data":{"id":"c2vi6e452q80","created":1589972402532,"text":"查询集表示从数据库中获取的对象的集合"},"children":[]},{"data":{"id":"c2vi6elm8w80","created":1589972403589,"text":"查询集可以有多个过滤器"},"children":[]},{"data":{"id":"c2vi6eshq000","created":1589972404005,"text":"过滤器就是一个函数，基于所给的参数限制查询集结果"},"children":[]},{"data":{"id":"c2via9abw4w0","created":1589972705479,"text":"从SQL角度来说，查询集合select语句等价，过滤器就像where条件"},"children":[]}]},{"data":{"id":"c2viaonfux40","created":1589972738924,"text":"查询集","resource":[],"expandState":"collapse","background":"#ffc000"},"children":[{"data":{"id":"c2vib0oozfk0","created":1589972765121,"text":"在管理器上调用过滤器方法返回查询集"},"children":[]},{"data":{"id":"c2vibjbm9qg0","created":1589972805689,"text":"查询集经过过滤器筛选后返回新的查询集，所以可以写成链式调用"},"children":[]},{"data":{"id":"c2vicbigz3s0","created":1589972867053,"text":"惰性执行","expandState":"collapse"},"children":[{"data":{"id":"c2vicibxf1s0","created":1589972881895,"text":"创建查询集不会带来任何数据库的访问，直到调用数据时，才会访问数据库"},"children":[]}]},{"data":{"id":"c2vicx28pxs0","created":1589972913961,"text":"直接访问数据的情况","expandState":"collapse"},"children":[{"data":{"id":"c2vid0m8wlk0","created":1589972921701,"text":"迭代"},"children":[]},{"data":{"id":"c2vid1o6mts0","created":1589972923995,"text":"序列化"},"children":[]},{"data":{"id":"c2vid3bm9ps0","created":1589972927589,"text":"与if合用"},"children":[]}]},{"data":{"id":"c2vmtgffoag0","created":1589985494384,"text":"返回查询集的方法称为过滤器","expandState":"collapse"},"children":[{"data":{"id":"c2vmtkctmt40","created":1589985502933,"text":"all()"},"children":[{"data":{"id":"c2vmug3f0j40","created":1589985572022,"text":"返回查询集的所有数据"},"children":[]}]},{"data":{"id":"c2vmtq3cy3c0","created":1589985515423,"text":"filter()","expandState":"expand"},"children":[{"data":{"id":"c2vmukdodao0","created":1589985581349,"text":"返回符合条件的数据"},"children":[]},{"data":{"id":"c2vmuod4jgg0","created":1589985590023,"text":"filter(键=值)"},"children":[]},{"data":{"id":"c2vmtsngk4g0","created":1589985520991,"text":"filter(键=值, 键=值)","expandState":"expand"},"children":[]},{"data":{"id":"c2vmu7r6w800","created":1589985553868,"text":"filter(键=值).filter(键=值)"},"children":[]}]},{"data":{"id":"c2vmuz3ekvk0","created":1589985613380,"text":"exclude()"},"children":[{"data":{"id":"c2vmv1x6s8o0","created":1589985619534,"text":"过滤掉符合条件的数据"},"children":[]}]},{"data":{"id":"c2vmv9injhk0","created":1589985636070,"text":"order_by()"},"children":[{"data":{"id":"c2vmvd1xekw0","created":1589985643765,"text":"排序"},"children":[]}]},{"data":{"id":"c2vmvf0nbds0","created":1589985648042,"text":"values()"},"children":[{"data":{"id":"c2vmvgxmngo0","created":1589985652213,"text":"一条数据就是一个对象（字典），返回一个列表"},"children":[]}]}]},{"data":{"id":"c2zwr6ifhfs0","created":1590419766995,"text":"返回单个数据","expandState":"collapse"},"children":[{"data":{"id":"c2zwrepudh40","created":1590419784857,"text":"get()"},"children":[{"data":{"id":"c2zwrg25wew0","created":1590419787779,"text":"返回一个满足条件的对象"},"children":[]},{"data":{"id":"c2zwrplvy3k0","created":1590419808563,"text":"注意"},"children":[{"data":{"id":"c2zwrsxkoog0","created":1590419815800,"text":"如果没有找到符合条件的对象，会引发<模型类.DoesNotExist>的异常"},"children":[]},{"data":{"id":"c2zwsqt5gi80","created":1590419889543,"text":"如果找到多个对象，也会引发<模型类.MultipleObjectsReturned>异常"},"children":[]}]}]},{"data":{"id":"c2zwzjf99fs0","created":1590420422014,"text":"count()"},"children":[{"data":{"id":"c2zwzl3vnog0","created":1590420425680,"text":"返回当前查询集中的对象个数"},"children":[]}]},{"data":{"id":"c2zwzqh010g0","created":1590420437357,"text":"first()"},"children":[{"data":{"id":"c2zwzrm6txk0","created":1590420439848,"text":"返回查询集中的第一个对象"},"children":[]}]},{"data":{"id":"c2zwzvgq0fc0","created":1590420448224,"text":"last()"},"children":[{"data":{"id":"c2zwzwj7os80","created":1590420450552,"text":"返回查询集中的最后一个对象"},"children":[]}]},{"data":{"id":"c2zwzzg5n1s0","created":1590420456897,"text":"exists()"},"children":[{"data":{"id":"c2zx01kdr3c0","created":1590420461506,"text":"判断查询集中是否有数据，返回True或False"},"children":[]}]}]},{"data":{"id":"c2zx2u3y2sg0","created":1590420680368,"text":"限制查询集","expandState":"collapse"},"children":[{"data":{"id":"c2zx2whwgww0","created":1590420685565,"text":"查询集返回列表，可以使用切片的方法进行限制，就等同于SQL中的LIMIT语句"},"children":[]},{"data":{"id":"c2zx4a9s6lc0","created":1590420793913,"text":"注意：下标不能用负数"},"children":[]},{"data":{"id":"c2zx4hwgm1s0","created":1590420810522,"text":"例：students_list = Students.stuObj2.all()[0:5]"},"children":[]}]},{"data":{"id":"c2zxgoeeviw0","created":1590421765038,"text":"查询集的缓存","expandState":"collapse"},"children":[{"data":{"id":"c2zxgr6achc0","created":1590421771077,"text":"概述","expandState":"collapse"},"children":[{"data":{"id":"c2zxh2747ts0","created":1590421795072,"text":"每个查询集都包含一个缓存，来最小化的对数据库访问"},"children":[]},{"data":{"id":"c2zxhbbib1c0","created":1590421814928,"text":"在新建的查询集中，缓存首次为空，第一次对查询集求值，会发生数据缓存，Django会将查询出来的数据做一个缓存并返回查询结果，以后的查询直接使用缓存"},"children":[]}]}]},{"data":{"id":"c2zxiymi6nc0","created":1590421944024,"text":"字段查询","expandState":"expand"},"children":[{"data":{"id":"c2zxj6pacz40","created":1590421961606,"text":"概述","expandState":"collapse"},"children":[{"data":{"id":"c2zxj7ihz9k0","created":1590421963372,"text":"实现了SQL中的where语句，作为方法filter(),exclude(),get()的参数"},"children":[]},{"data":{"id":"c2zxk1ajk7k0","created":1590422028195,"text":"语法"},"children":[{"data":{"id":"c2zxk2gz0ts0","created":1590422030760,"text":"属性名称__比较运算符 = 值   （下划线是两个）"},"children":[]}]},{"data":{"id":"c2zxkivdta80","created":1590422066460,"text":"外键"},"children":[{"data":{"id":"c2zxko6449k0","created":1590422077993,"text":"属性名_id"},"children":[]}]},{"data":{"id":"c2zxkyvlzsw0","created":1590422101302,"text":"转义"},"children":[{"data":{"id":"c2zxl26o7p40","created":1590422108502,"text":"SQL的LIKE语句中使用%是为了匹配占位，匹配%用<where like \"\\%\">"},"children":[]},{"data":{"id":"c2zxle5rv5s0","created":1590422134569,"text":"filter中%没有匹配占位的功能"},"children":[]}]}]},{"data":{"id":"c2zxj8c8se00","created":1590421965171,"text":"比较运算符","expandState":"collapse"},"children":[{"data":{"id":"c31nk4ud7fc0","created":1590596944738,"text":"exact"},"children":[{"data":{"id":"c31nk6xwvko0","created":1590596949306,"text":"判断，大小写敏感"},"children":[]},{"data":{"id":"c31nkcybyao0","created":1590596962392,"text":"例如：filter(isDelete=False)"},"children":[]}]},{"data":{"id":"c31nkl2ocq80","created":1590596980069,"text":"contains"},"children":[{"data":{"id":"c31nkmfyv140","created":1590596983049,"text":"是否包含，大小写敏感"},"children":[]},{"data":{"id":"c31npfvzlnk0","created":1590597360602,"text":"例子"},"children":[{"data":{"id":"c31nphyrheo0","created":1590597365123,"text":"查询名字中带“孙”的学生","image":"https://kityminder-img.gz.bcebos.com/5d79440481dd6eb3ae0e55e01f63b3f2fec8fe3d","imageSize":{"width":200,"height":18}},"children":[{"data":{"id":"c32vzxui7680","created":1590722312171,"text":"students_list = Students.stuObj2.filter(name__contains='孙')"},"children":[]}]}]}]},{"data":{"id":"c31nq1h9i3s0","created":1590597407600,"text":"startswith, endswith"},"children":[{"data":{"id":"c31nq8pjki00","created":1590597423338,"text":"以value开头或结尾，大小写敏感"},"children":[]},{"data":{"id":"c31nrgfsjds0","created":1590597518527,"text":"例子"},"children":[{"data":{"id":"c31nrhbatnk0","created":1590597520432,"text":"查询名字以“刘”开头的学生","image":"https://kityminder-img.gz.bcebos.com/c881c1b034ce33095af3f055111610336fade532","imageSize":{"width":200,"height":24}},"children":[{"data":{"id":"c32w01sa1og0","created":1590722320744,"text":"students_list = Students.stuObj2.filter(name__startswith='刘')"},"children":[]}]}]}]},{"data":{"id":"c31nrvmhfo00","created":1590597551584,"text":"以上四个运算符在前面加上i,就表示不区分大小写"},"children":[{"data":{"id":"c31ns5erp880","created":1590597572885,"text":"iexact, icontains, istartswith, iendswith"},"children":[]}]},{"data":{"id":"c31nsdey96w0","created":1590597590310,"text":"isnul, isnotnull"},"children":[{"data":{"id":"c31nsg1lmg00","created":1590597596033,"text":"是否为空"},"children":[]},{"data":{"id":"c31nsirbmvs0","created":1590597601942,"text":"filter(name__isnull=False)"},"children":[]}]},{"data":{"id":"c31nsqcflc80","created":1590597618456,"text":"in"},"children":[{"data":{"id":"c31nsr3ezeg0","created":1590597620088,"text":"是否包含在范围内"},"children":[]},{"data":{"id":"c31ntv7b2hs0","created":1590597707394,"text":"例子"},"children":[{"data":{"id":"c31ntw2syxc0","created":1590597709299,"text":"查询孙武和刘德华","image":"https://kityminder-img.gz.bcebos.com/4c01fd00c8ebf42584c783798af3ed198c193d8e","imageSize":{"width":200,"height":18}},"children":[{"data":{"id":"c32w05ls0ig0","created":1590722329058,"text":"students_list = Students.stuObj2.filter(name__in=['刘德华', '孙武'])"},"children":[]}]}]}]},{"data":{"id":"c31nuah8af40","created":1590597740646,"text":"gt, gte, lt, lte"},"children":[{"data":{"id":"c31nuf90bio0","created":1590597751033,"text":"大于，大于等于， 小于， 小于等于"},"children":[{"data":{"id":"c31nukg05sw0","created":1590597762340,"text":"查询年龄大于20的学生","image":"https://kityminder-img.gz.bcebos.com/7e0e6a9b35aceb680ebe3d188e1804d0c056e952","imageSize":{"width":200,"height":18}},"children":[{"data":{"id":"c32w09javuw0","created":1590722337615,"text":"students_list = Students.stuObj2.filter(age__gt=20)"},"children":[]}]}]}]},{"data":{"id":"c31nvgy67ao0","created":1590597833095,"text":"year, month, day, week_day, hour, minute, second"},"children":[{"data":{"id":"c31nwtbu1800","created":1590597938407,"text":"查询lastTime是2020年的学生","image":"https://kityminder-img.gz.bcebos.com/84cde103a4c696f01b6edc78c43b21132fe234b8","imageSize":{"width":200,"height":24}},"children":[{"data":{"id":"c32w0y00h400","created":1590722390869,"text":"students_list = Students.stuObj2.filter(lastTime__year=2020)"},"children":[]}]}]},{"data":{"id":"c31o2ycex7k0","created":1590598419511,"text":"跨关联查询"},"children":[{"data":{"id":"c31o31dqbcw0","created":1590598426121,"text":"处理join查询"},"children":[{"data":{"id":"c31o34mkd5s0","created":1590598433185,"text":"语法"},"children":[{"data":{"id":"c31o3610iwg0","created":1590598436236,"text":"模型类名__属性名__比较运算符"},"children":[]}]},{"data":{"id":"c32036t4ark0","created":1590632291254,"text":"例子"},"children":[{"data":{"id":"c320398ffyg0","created":1590632296533,"text":"找出姓名里带有“刘”的同学的班级","image":"https://kityminder-img.gz.bcebos.com/8a3d2187bea98b3d635b0758718554d90b89d757","imageSize":{"width":200,"height":27}},"children":[{"data":{"id":"c32w14nvvx40","created":1590722405373,"text":"grades_list = Grades.graObj.filter(students__name__contains='刘')"},"children":[]}]}]}]}]},{"data":{"id":"c31oc2k6rrk0","created":1590599133966,"text":"查询快捷"},"children":[{"data":{"id":"c31oc4kcoy80","created":1590599138329,"text":"pk"},"children":[{"data":{"id":"c31oc669x0g0","created":1590599141831,"text":"主键"},"children":[]}]}]}]},{"data":{"id":"c2zxjaftjyg0","created":1590421969741,"text":"聚合函数","expandState":"collapse"},"children":[{"data":{"id":"c31ocjrnu7s0","created":1590599171423,"text":"使用aggregate()函数返回聚合函数的值"},"children":[]},{"data":{"id":"c31oczj1eaw0","created":1590599205730,"text":"Avg"},"children":[]},{"data":{"id":"c31od3s4fvk0","created":1590599214986,"text":"Count"},"children":[]},{"data":{"id":"c31od5g3rts0","created":1590599218613,"text":"Max"},"children":[{"data":{"id":"c31oft2uxgg0","created":1590599426783,"text":"例子","image":"https://kityminder-img.gz.bcebos.com/51fbae14081fb760130101871bccd8a7e1ccd177","imageSize":{"width":200,"height":34}},"children":[{"data":{"id":"c32w1l6y5dc0","created":1590722441354,"text":"maxAge = Students.stuObj2.aggregate(Max('age'))\nprint(maxAge)"},"children":[]}]}]},{"data":{"id":"c31od6u8pso0","created":1590599221645,"text":"Min"},"children":[]},{"data":{"id":"c31od7sl5mo0","created":1590599223722,"text":"Sum"},"children":[]}]},{"data":{"id":"c2zxjbw7x0g0","created":1590421972909,"text":"F对象","expandState":"collapse"},"children":[{"data":{"id":"c31og9c4gww0","created":1590599462172,"text":"实现模型的A属性与B属性进行比较"},"children":[{"data":{"id":"c31omd29fi00","created":1590599940468,"text":"找到女生比男生多的班级","image":"https://kityminder-img.gz.bcebos.com/a3848e743eaff6e34a530137dc1459d2cf04bf69","imageSize":{"width":200,"height":42}},"children":[{"data":{"id":"c32w1xkmzdk0","created":1590722468303,"text":"g = Grades.graObj.filter(girl_num__gt=F('boy_num'))\nprint(g)"},"children":[]}]}]},{"data":{"id":"c31onaqywk80","created":1590600013796,"text":"支持F对象的算术运算"},"children":[{"data":{"id":"c31onow95rs0","created":1590600044590,"text":"例子","image":"https://kityminder-img.gz.bcebos.com/a784c0ea2626d65c27adc04f81a19605513b0a1a","imageSize":{"width":200,"height":30}},"children":[{"data":{"id":"c32w1xkmzdk0","created":1590722468303,"text":"g = Grades.graObj.filter(girl_num__gt=F('boy_num')+20)\nprint(g)"},"children":[]}]}]}]},{"data":{"id":"c2zxjdjguts0","created":1590421976492,"text":"Q对象","expandState":"collapse"},"children":[{"data":{"id":"c31zoyiwlso0","created":1590631176124,"text":"概述"},"children":[{"data":{"id":"c31zp0fea2w0","created":1590631180265,"text":"过滤器的方法中的关键字参数，条件为And模式"},"children":[]}]},{"data":{"id":"c31zpmkb5eo0","created":1590631228452,"text":"Q对象目的"},"children":[{"data":{"id":"c31zpogp61k0","created":1590631232587,"text":"实现or关系的查询"},"children":[]}]},{"data":{"id":"c31zwaic2k00","created":1590631750760,"text":"例子"},"children":[{"data":{"id":"c31zvp6a4u80","created":1590631704319,"text":"students_list = Students.stuObj2.filter(Q(pk__lte=3) | Q(age__gt=50))","image":"https://kityminder-img.gz.bcebos.com/692c7df75b0e619bb12482eaf57a35ecef7b00a7","imageSize":{"width":200,"height":10}},"children":[]},{"data":{"id":"c31zxtyr1nc0","created":1590631871476,"text":"~代表取反","image":"https://kityminder-img.gz.bcebos.com/d2a4b36c9cfa2a0877c748b88a77f552c20e96c9","imageSize":{"width":200,"height":12}},"children":[{"data":{"id":"c32w709oq080","created":1590722865992,"text":"students_list = Students.stuObj2.filter(~Q(pk__lte=3))"},"children":[]}]}]}]}]}]}]}]},"template":"right","theme":"snow-compact","version":"1.4.43"}