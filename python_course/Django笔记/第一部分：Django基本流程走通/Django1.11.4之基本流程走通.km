{"root":{"data":{"id":"26d8a35a4842","created":1587629122,"text":"Django1.11.4之基本流程走通","priority":null,"expandState":"expand"},"children":[{"data":{"id":"c28fl1jills0","created":1587629208293,"text":"设计模式","layout":null,"expandState":"collapse","priority":null,"progress":null,"resource":[],"layout_tianpan_offset":{"x":2.499999962747097,"y":0}},"children":[{"data":{"id":"c28fma0a1zs0","created":1587629305085,"text":"MVC","expandState":"collapse","layout":null},"children":[{"data":{"id":"c28fmche4f40","created":1587629310473,"text":"核心思想","expandState":"expand","layout":null},"children":[{"data":{"id":"c28fmf2chgg0","created":1587629316094,"text":"解耦","expandState":"expand","layout":null},"children":[]}]},{"data":{"id":"c28fmloybe00","created":1587629330522,"text":"浏览器请求发送给Controller，Controller把需求发给Model,Model返回数据给Controller,Controller把数据传送给View渲染，View返回给浏览器","expandState":"expand","layout":null},"children":[]},{"data":{"id":"c28fnp1o9ps0","created":1587629416185,"text":"编程模式","expandState":"expand","layout":null},"children":[{"data":{"id":"c28fnrjhxso0","created":1587629421617,"text":"Model（模型）","expandState":"expand","layout":null},"children":[{"data":{"id":"c28fnt6lsv40","created":1587629425191,"text":"应用程序中处理数据逻辑的部分","expandState":"expand","layout":null},"children":[]},{"data":{"id":"c28fnzzwn3c0","created":1587629440023,"text":"通常模型对象负责在数据库中存取数据","expandState":"expand","layout":null},"children":[]}]},{"data":{"id":"c28fo79xp3k0","created":1587629455867,"text":"View（视图）","expandState":"expand","layout":null},"children":[{"data":{"id":"c28fodjn32g0","created":1587629469515,"text":"处理数据显示的部分","expandState":"expand","layout":null},"children":[]},{"data":{"id":"c28fohn0lls0","created":1587629478426,"text":"通常视图是依据模型数据创建的","expandState":"expand","layout":null},"children":[]}]},{"data":{"id":"c28foa0p5q00","created":1587629461839,"text":"Controller（控制器）","expandState":"expand","layout":null},"children":[{"data":{"id":"c28fop9jqgg0","created":1587629495026,"text":"处理用户交互的部分","expandState":"expand","layout":null},"children":[]},{"data":{"id":"c28fpjqfzwo0","created":1587629561351,"text":"负责从视图读取数据，通知用户输入，并向模型发送数据","expandState":"expand","layout":null},"children":[]}]}]},{"data":{"id":"c28fpbvyqt40","created":1587629544270,"text":"优点","expandState":"expand","layout":null},"children":[{"data":{"id":"c28fq2yxcf40","created":1587629603222,"text":"降低了各功能模块之间的耦合性，方便重构代码，最大程度上实现了代码重用","expandState":"expand","layout":null},"children":[]}]}]},{"data":{"id":"c28fsgh6dsw0","created":1587629789353,"text":"MTV","expandState":"expand","layout":null,"layout_right_offset":{"x":6,"y":3}},"children":[{"data":{"id":"c28fsxim0ao0","created":1587629826445,"text":"概述","expandState":"expand","layout":null},"children":[{"data":{"id":"c28ft0a8tww0","created":1587629832469,"text":"本质与MVC没有区别，各组件之间为了保持松耦合关系","expandState":"expand","layout":null},"children":[]}]},{"data":{"id":"c28fteg8ugo0","created":1587629863307,"text":"编程模式","expandState":"expand","layout":null},"children":[{"data":{"id":"c28fthl3wko0","created":1587629870131,"text":"Model（模型）","expandState":"expand","layout":null},"children":[{"data":{"id":"c28ftmh16480","created":1587629880769,"text":"负责业务对象与数据库的对象（ORM）","expandState":"expand","layout":null},"children":[]}]},{"data":{"id":"c28ftlaqg5c0","created":1587629878211,"text":"Template（模板）相当于MVC里的View","expandState":"expand","layout":null},"children":[{"data":{"id":"c28ftx996zk0","created":1587629904243,"text":"负责把页面展示给用户","expandState":"expand","layout":null},"children":[]}]},{"data":{"id":"c28fu61tpc80","created":1587629923385,"text":"View（视图）相当于MVC里的Controller","expandState":"expand","layout":null},"children":[{"data":{"id":"c28fuhrrzg80","created":1587629948899,"text":"负责业务逻辑，并在适当时候调用Model和Template","expandState":"expand","layout":null},"children":[]}]}]},{"data":{"id":"c28fv1mmkb40","created":1587629992123,"text":"注意","expandState":"expand","layout":null},"children":[{"data":{"id":"c28fv31zos00","created":1587629995229,"text":"Django还有一个url分发器，作用是将一个个URL分发给不同的View处理","expandState":"expand","layout":null},"children":[]}]},{"data":{"id":"c28fvm0hhp40","created":1587630036496,"text":"图解","expandState":"expand","layout":null},"children":[{"data":{"id":"c28fvnwyo7k0","created":1587630040637,"text":"双击放大","image":"https://kityminder-img.gz.bcebos.com/733101e751f65d4cbc6a23c91bd70339d2435932","imageTitle":"","imageSize":{"width":200,"height":85},"expandState":"expand","layout":null},"children":[]},{"data":{"id":"c28fx3b5i000","created":1587630152511,"text":"说明：1.用户输入URL，通过URL控制器进行正则匹配，匹配到相应的视图函数，交给视图处理；2.视图交给Model去取数据，Model取完数据返回给视图；3.视图再把需要展示的数据传给模板（就是html页面）","expandState":"expand","layout":null},"children":[]}]}]}]},{"data":{"id":"c28fzoavj9k0","created":1587630354935,"text":"安装 Django1.11.4版本","expandState":"collapse","layout":null,"progress":null},"children":[{"data":{"id":"c28g02z029c0","created":1587630386869,"text":"Django与Python对应版本自行百度","expandState":"expand","layout":null},"children":[]},{"data":{"id":"c28g08tko0g0","created":1587630399601,"text":"安装步骤","expandState":"expand","layout":null},"children":[{"data":{"id":"c28g0bxao600","created":1587630406357,"text":"进入终端","expandState":"expand","layout":null},"children":[]},{"data":{"id":"c28g0f3ko3c0","created":1587630413267,"text":"输入 pip install Django==1.11.4","expandState":"expand","layout":null},"children":[]},{"data":{"id":"c28g0luadc80","created":1587630427943,"text":"验证是否安装成功","expandState":"expand","layout":null},"children":[{"data":{"id":"c28g0vqz5eg0","created":1587630449510,"text":"进入Python环境","expandState":"expand","layout":null},"children":[]},{"data":{"id":"c28g0ziv6g00","created":1587630457727,"text":"import django","expandState":"expand","layout":null},"children":[]},{"data":{"id":"c28g11t98so0","created":1587630462709,"text":"django.get_version()","expandState":"expand","layout":null},"children":[]}]}]}]},{"data":{"id":"c28g1mbn2l40","created":1587630507356,"text":"创建项目","expandState":"collapse","layout":null,"progress":null},"children":[{"data":{"id":"c28g1xqhbm80","created":1587630532198,"text":"创建目录","expandState":"expand","layout":null},"children":[]},{"data":{"id":"c28g1zh2s1s0","created":1587630535983,"text":"打开终端进入刚才创建的目录下","expandState":"expand","layout":null},"children":[]},{"data":{"id":"c28g24d060o0","created":1587630546620,"text":"输入  django-admin startproject djangodemo(最后一个是项目名称)","expandState":"expand","layout":null},"children":[]},{"data":{"id":"c28g3bhhrsw0","created":1587630640494,"text":"输入   tree .  /F    查看目录层级","expandState":"expand","layout":null},"children":[]},{"data":{"id":"c28g3wipek00","created":1587630686279,"text":"目录层级","expandState":"expand","layout":null},"children":[{"data":{"id":"c28g401tgoo0","created":1587630693965,"text":"manage.py","expandState":"expand","layout":null},"children":[{"data":{"id":"c28g4imoc400","created":1587630734409,"text":"一个命令行工具，用于我们和Django的交互","expandState":"expand","layout":null},"children":[]}]},{"data":{"id":"c28g42k7ek00","created":1587630699431,"text":"project目录","expandState":"expand","layout":null},"children":[{"data":{"id":"c28g466sqbk0","created":1587630707327,"text":"__init__.py","expandState":"expand","layout":null},"children":[{"data":{"id":"c28g4r25aq00","created":1587630752758,"text":"空文件，告诉Python这个目录应该被看做一个Python包","expandState":"expand","layout":null},"children":[]}]},{"data":{"id":"c28g4awkodc0","created":1587630717593,"text":"settings.py","expandState":"expand","layout":null},"children":[{"data":{"id":"c28g4yvxync0","created":1587630769797,"text":"项目配置文件","expandState":"expand","layout":null},"children":[]}]},{"data":{"id":"c28g4crtn1c0","created":1587630721659,"text":"urls.py","expandState":"expand","layout":null},"children":[{"data":{"id":"c28g52hig5s0","created":1587630777632,"text":"URL分发器，项目的URL声明","expandState":"expand","layout":null},"children":[]}]},{"data":{"id":"c28g4eo9qog0","created":1587630725798,"text":"wsgi.py","expandState":"expand","layout":null},"children":[{"data":{"id":"c28g5eefys00","created":1587630803568,"text":"项目与WSGI兼容的web服务器入口","expandState":"expand","layout":null},"children":[]}]}]}]}]},{"data":{"id":"c28g6dvvry00","created":1587630880810,"text":"基本操作","expandState":"collapse","layout":null,"progress":null},"children":[{"data":{"id":"c28g6h3io4g0","created":1587630887802,"text":"设计表结构","expandState":"expand","layout":null},"children":[{"data":{"id":"c28g6ld1ex40","created":1587630897085,"text":"数据库的知识，随意设计就行了","expandState":"expand","layout":null},"children":[]},{"data":{"id":"c28g70drco00","created":1587630929780,"text":"班级表","expandState":"expand","layout":null},"children":[]},{"data":{"id":"c28g725dg940","created":1587630933626,"text":"学生表","expandState":"expand","layout":null},"children":[]}]},{"data":{"id":"c28gbssg4m00","created":1587631305075,"text":"配置数据库","expandState":"expand","layout":null},"children":[{"data":{"id":"c28gbvvrr8o0","created":1587631311806,"text":"Django默认数据库是SQLite","expandState":"expand","layout":null},"children":[]},{"data":{"id":"c28gc8atosg0","created":1587631338837,"text":"settings.py中，通过DATABASES配置数据库","expandState":"expand","layout":null},"children":[]},{"data":{"id":"c28gdu1mpe80","created":1587631464535,"text":"配置MySQL","expandState":"expand","layout":null},"children":[{"data":{"id":"c28gdwu6uiw0","created":1587631470615,"text":"用pymysql库","expandState":"expand","layout":null},"children":[]},{"data":{"id":"c28ge4du8o00","created":1587631487041,"text":"在__init__.py中写入两行代码","expandState":"expand","layout":null},"children":[{"data":{"id":"c28gegjgfdk0","created":1587631513502,"text":"import pymysql\npymysql.install_as_MySQLdb()","expandState":"expand","layout":null},"children":[]}]},{"data":{"id":"c28gfdnikeg0","created":1587631585581,"text":"settings.py中","expandState":"expand","layout":null},"children":[{"data":{"id":"c28gfj975280","created":1587631597776,"text":"DATABASES = {\n\t'default': {\n\t    'ENGINE': 'django.db.backends.mysql',\n\t    'NAME': 'djangodemo2',\n\t    'USER': 'root',\n\t    'PASSWORD': '123456',\n\t    'HOST': 'localhost',\n\t    'PORT': '3306',\n\t}\n}","expandState":"expand","layout":null},"children":[{"data":{"id":"c28gh7kw8gg0","created":1587631729090,"text":"NAME中填数据库名","expandState":"expand","layout":null},"children":[]},{"data":{"id":"c28ghfg0r6o0","created":1587631746210,"text":"USER和PASSWORD分别是用户名和密码","expandState":"expand","layout":null},"children":[]},{"data":{"id":"c28ghplfawo0","created":1587631768305,"text":"HOST为数据库服务器ip，直接填本地主机","expandState":"expand","layout":null},"children":[]},{"data":{"id":"c28ght0ntb40","created":1587631775756,"text":"PORT为3306默认端口","expandState":"expand","layout":null},"children":[]}]}]}]}]},{"data":{"id":"c28gin67tco0","created":1587631841396,"text":"创建应用","expandState":"expand","layout":null},"children":[{"data":{"id":"c28giz2tmn40","created":1587631867312,"text":"一个项目可以创建多个应用，每个应用负责一种业务","expandState":"expand","layout":null},"children":[]},{"data":{"id":"c28gjbsisu80","created":1587631894987,"text":"打开终端，进入项目目录，结构为：","expandState":"expand","layout":null},"children":[{"data":{"id":"c28gkgr3w9s0","created":1587631984150,"text":"│  manage.py\n└─djangodemo2\n\t   settings.py\n\t   urls.py\n\t   wsgi.py\n\t   __init__.py","expandState":"expand","layout":null},"children":[]}]},{"data":{"id":"c28gjf4txxk0","created":1587631902262,"text":"执行python manage.py startapp myApp","expandState":"expand","layout":null},"children":[{"data":{"id":"c28gmgfq5vs0","created":1587632140190,"text":"创建一个名为myApp的应用","expandState":"expand","layout":null},"children":[]}]},{"data":{"id":"c28gn0kifkg0","created":1587632184015,"text":"myApp目录说明","expandState":"expand","layout":null},"children":[{"data":{"id":"c28gn3xj2vc0","created":1587632191332,"text":"admin.py","expandState":"expand","layout":null},"children":[{"data":{"id":"c28gnaxjz5c0","created":1587632206571,"text":"站点配置","expandState":"expand","layout":null},"children":[]}]},{"data":{"id":"c28gn65r3cg0","created":1587632196183,"text":"models.py","expandState":"expand","layout":null},"children":[{"data":{"id":"c28gndrgokg0","created":1587632212733,"text":"模型","expandState":"expand","layout":null},"children":[]}]},{"data":{"id":"c28gn8ox2uo0","created":1587632201695,"text":"views.py","expandState":"expand","layout":null},"children":[{"data":{"id":"c28gnfae6mw0","created":1587632216055,"text":"视图","expandState":"expand","layout":null},"children":[]}]}]}]},{"data":{"id":"c28gnnfuvgo0","created":1587632233799,"text":"激活应用（将应用配置到项目中）","expandState":"expand","layout":null},"children":[{"data":{"id":"c28gnuh5tz40","created":1587632249116,"text":"settings.py文件中，将myApp加入到INSTALLED_APPS中","expandState":"expand","layout":null},"children":[{"data":{"id":"c28goh8vsm00","created":1587632298681,"text":"# Application definition\n\nINSTALLED_APPS = [\n\t'django.contrib.admin',\n\t'django.contrib.auth',\n\t'django.contrib.contenttypes',\n\t'django.contrib.sessions',\n\t'django.contrib.messages',\n\t'django.contrib.staticfiles',\n\t'myApp'\n]","expandState":"expand","layout":null},"children":[]}]}]},{"data":{"id":"c28gosvj7qo0","created":1587632323995,"text":"定义模型（对接数据库）","expandState":"expand","layout":null},"children":[{"data":{"id":"c28gpihawtc0","created":1587632379731,"text":"一个数据库表对应一个模型","expandState":"expand","layout":null},"children":[]},{"data":{"id":"c28gpucz0g00","created":1587632405591,"text":"在models.py中定义","expandState":"expand","layout":null},"children":[{"data":{"id":"c28gq6w6bmg0","created":1587632432873,"text":"from django.db import models","expandState":"expand","layout":null},"children":[]},{"data":{"id":"c28gqbgqhxc0","created":1587632442824,"text":"模型类要继承models.Model类","expandState":"expand","layout":null},"children":[]},{"data":{"id":"c28gsf5n9c00","created":1587632607588,"text":"class Grades(models.Model):\n\tname = models.CharField(max_length=20)\n\tdate = models.DateTimeField()\n\tgirl_num = models.IntegerField()\n\tboy_num = models.IntegerField()\n\tisDelete = models.BooleanField(default=False)\n\n\t# 更改Grades.objects.all()的输出内容\n\tdef __str__(self):\n\t    return \"%s-%d-%d\" % (self.name, self.girl_num, self.boy_num)\n\n\nclass Students(models.Model):\n\tname = models.CharField(max_length=20)\n\tgender = models.BooleanField(default=True)\n\tage = models.IntegerField()\n\tcontend = models.CharField(max_length=20)\n\tisDelete = models.BooleanField(default=False)\n\t# 外键\n\tgrade = models.ForeignKey(\"Grades\")","expandState":"expand","layout":null},"children":[{"data":{"id":"c28gsm4lgj40","created":1587632622762,"text":"两个类对应库中的两个表，字段名与老师的略有不同","expandState":"expand","layout":null},"children":[]}]}]},{"data":{"id":"c28gse7zrhc0","created":1587632605554,"text":"说明：不需要定义主键，主键在生成表时自动添加，并默认值自动添加","expandState":"expand","layout":null},"children":[]}]},{"data":{"id":"c28gtt7d9kw0","created":1587632716532,"text":"生成数据表","expandState":"expand","layout":null},"children":[{"data":{"id":"c28gtyuupu00","created":1587632728836,"text":"生成迁移文件","expandState":"expand","layout":null},"children":[{"data":{"id":"c28gu7efhk00","created":1587632747434,"text":"终端中执行：  python manage.py makemigrations ","expandState":"expand","layout":null},"children":[{"data":{"id":"c28gv6dlxbs0","created":1587632823571,"text":"myApp的目录migrations下生成一个迁移文件","expandState":"expand","layout":null},"children":[]}]}]},{"data":{"id":"c28gu1s421c0","created":1587632735200,"text":"执行迁移","expandState":"expand","layout":null},"children":[{"data":{"id":"c28gw01eri00","created":1587632888137,"text":"终端中执行： python manage.py migrate","expandState":"expand","layout":null},"children":[{"data":{"id":"c28gwbp1z8o0","created":1587632913512,"text":"数据库中会生成一系列表","expandState":"expand","layout":null},"children":[]}]}]},{"data":{"id":"c28o56tigxk0","created":1587653355944,"text":"如果重新迁移的话，需要删除0001.initial.py文件，把数据库也一块删除，然后再生成迁移文件，再迁移","layout":null},"children":[]},{"data":{"id":"c28o6chp6i00","created":1587653446655,"text":"新增一张表的话不需要重新迁移，直接生成0002的迁移文件，再执行迁移即可","layout":null},"children":[]},{"data":{"id":"c28o7ljy6io0","created":1587653544746,"text":"修改原表的字段的话，需要重新迁移","layout":null},"children":[]}]},{"data":{"id":"c28gx8dkgbk0","created":1587632984651,"text":"测试操作数据","expandState":"expand","layout":null},"children":[{"data":{"id":"c28gxcc91i00","created":1587632993278,"text":"进入python shell","expandState":"expand","layout":null},"children":[{"data":{"id":"c28gxhbx6og0","created":1587633004142,"text":"执行python manage.py shell","expandState":"expand","layout":null},"children":[]}]},{"data":{"id":"c28gxpl0i740","created":1587633022106,"text":"引入一些包","expandState":"expand","layout":null},"children":[{"data":{"id":"c28gxw8juds0","created":1587633036590,"text":"from myApp.models import Grades, Students\nfrom django.utils import timezone\nfrom datatime import *","expandState":"expand","layout":null},"children":[]}]},{"data":{"id":"c28h046qac00","created":1587633210623,"text":"查询班级表所有数据","expandState":"expand","layout":null},"children":[{"data":{"id":"c28h08jycxk0","created":1587633220129,"text":"Grades.objects.all()","expandState":"expand","layout":null},"children":[]}]},{"data":{"id":"c28h0hpm87c0","created":1587633240063,"text":"添加数据","expandState":"expand","layout":null},"children":[{"data":{"id":"c28h0v3e1480","created":1587633269194,"text":"本质：创建一个模型类的对象实例","expandState":"expand","layout":null},"children":[]},{"data":{"id":"c28h0zm4yw00","created":1587633279035,"text":"grade1  = Grades()","expandState":"expand","layout":null},"children":[{"data":{"id":"c28h1n8g2i00","created":1587633330449,"text":"创建一个空实例","expandState":"expand","layout":null},"children":[]}]},{"data":{"id":"c28h1r62n4o0","created":1587633339013,"text":"grade1.name = 'python'","expandState":"expand","layout":null},"children":[{"data":{"id":"c28h1wd8tbk0","created":1587633350331,"text":"名字","expandState":"expand","layout":null},"children":[]}]},{"data":{"id":"c28h23raweo0","created":1587633366418,"text":"grade1.date = datetime(yaer=2020, month=4, day=23)","expandState":"expand","layout":null},"children":[{"data":{"id":"c28h2jcfc7c0","created":1587633400347,"text":"日期","expandState":"expand","layout":null},"children":[]}]},{"data":{"id":"c28h2v3ims00","created":1587633425930,"text":"grade1.save()","expandState":"expand","layout":null},"children":[{"data":{"id":"c28h2z1hdc80","created":1587633434514,"text":"将刚才创建的grade1实例传给数据库，创建一条数据","expandState":"expand","layout":null},"children":[]}]},{"data":{"id":"c28h4sjb3aw0","created":1587633577083,"text":"重写类的__str__函数使之更好地显示数据","expandState":"expand","layout":null},"children":[{"data":{"id":"c28h501nxsw0","created":1587633593430,"text":"class Grades(models.Model):","expandState":"expand","layout":null},"children":[{"data":{"id":"c28h53wmpbs0","created":1587633601833,"text":"name = models.CharField(max_length=20)","expandState":"expand","layout":null},"children":[]},{"data":{"id":"c28h53wolxc0","created":1587633601836,"text":"date = models.DateTimeField()","expandState":"expand","layout":null},"children":[]},{"data":{"id":"c28h53wpcx40","created":1587633601837,"text":"girl_num = models.IntegerField()","expandState":"expand","layout":null},"children":[]},{"data":{"id":"c28h53wpsgo0","created":1587633601838,"text":"boy_num = models.IntegerField()","expandState":"expand","layout":null},"children":[]},{"data":{"id":"c28h53wqd4g0","created":1587633601839,"text":"isDelete = models.BooleanField(default=False)","expandState":"expand","layout":null},"children":[]},{"data":{"id":"c28h53wq51s0","created":1587633601839,"text":"# 更改Grades.objects.all()的输出内容","expandState":"expand","layout":null},"children":[]},{"data":{"id":"c28h53wqe400","created":1587633601839,"text":"def __str__(self):","expandState":"expand","layout":null},"children":[{"data":{"id":"c28h53wqiqw0","created":1587633601839,"text":"return \"%s-%d-%d\" % (self.name, self.girl_num, self.boy_num)","expandState":"expand","layout":null},"children":[]}]}]}]}]},{"data":{"id":"c28h5nofvd40","created":1587633644873,"text":"查看某个数据","expandState":"expand","layout":null},"children":[{"data":{"id":"c28h5rjj3a00","created":1587633653283,"text":"Grades.objects.all()","expandState":"expand","layout":null},"children":[{"data":{"id":"c28h6ay0oog0","created":1587633695518,"text":"查询所有","expandState":"expand","layout":null},"children":[]}]},{"data":{"id":"c28h6edngww0","created":1587633702994,"text":"类名.objects.get(pk=2)","expandState":"expand","layout":null},"children":[{"data":{"id":"c28h6mb70xs0","created":1587633720260,"text":"查询id为2的那一条数据","expandState":"expand","layout":null},"children":[]}]},{"data":{"id":"c28h6l9ulko0","created":1587633718002,"text":"分支主题","expandState":"expand","layout":null},"children":[]}]},{"data":{"id":"c28h6zoi7ps0","created":1587633749363,"text":"修改数据","expandState":"expand","layout":null},"children":[{"data":{"id":"c28h73w19qg0","created":1587633758525,"text":"模型对象.属性 = 新值","expandState":"expand","layout":null},"children":[{"data":{"id":"c28h78oruug0","created":1587633768970,"text":"grade.name = 'c++'","expandState":"expand","layout":null},"children":[]}]},{"data":{"id":"c28h7d2zziw0","created":1587633778537,"text":"模型对象.save()","expandState":"expand","layout":null},"children":[{"data":{"id":"c28h7jib3eo0","created":1587633792524,"text":"grade.save()","expandState":"expand","layout":null},"children":[]}]}]},{"data":{"id":"c28h7miwyjk0","created":1587633799091,"text":"删除数据（物理删除）","expandState":"expand","layout":null},"children":[{"data":{"id":"c28h7plveuw0","created":1587633805800,"text":"g = Grades.objects.get(pk=2)","expandState":"expand","layout":null},"children":[]},{"data":{"id":"c28h80zdhzs0","created":1587633830561,"text":"g.delete()","expandState":"expand","layout":null},"children":[]}]},{"data":{"id":"c28h9vuoocw0","created":1587633976122,"text":"关联对象","expandState":"expand","layout":null},"children":[{"data":{"id":"c28ha2grnts0","created":1587633990518,"text":"stu = Students()","expandState":"expand","layout":null},"children":[]},{"data":{"id":"c28ha5f6z4o0","created":1587633996953,"text":"stu.name = 'zcz'","expandState":"expand","layout":null},"children":[]},{"data":{"id":"c28ha967sfc0","created":1587634005117,"text":"......","expandState":"expand","layout":null},"children":[]},{"data":{"id":"c28hajbh4s80","created":1587634027203,"text":"获得关联对象的集合","expandState":"expand","layout":null},"children":[{"data":{"id":"c28han0epx40","created":1587634035241,"text":"需求：获取某个班级的所有学生","expandState":"expand","layout":null},"children":[]},{"data":{"id":"c28hbhtnee80","created":1587634102313,"text":"类名.关联的类名小写_set.all()","expandState":"expand","layout":null},"children":[{"data":{"id":"c28hbpdqg0w0","created":1587634118764,"text":"grade1.students_set.all()","expandState":"expand","layout":null},"children":[{"data":{"id":"c28hbvs6oig0","created":1587634132699,"text":"students_set是自带的方法","expandState":"expand","layout":null},"children":[]}]}]}]},{"data":{"id":"c28hc98m7ig0","created":1587634161991,"text":"需求：创建某个人，属于某个班级","expandState":"expand","layout":null},"children":[{"data":{"id":"c28hchldqko0","created":1587634180177,"text":"stu3 = grade1.setudents_set.create(name=u'曾志伟', gender=True, ......)","expandState":"expand","layout":null},"children":[]},{"data":{"id":"c28hd5kwsvs0","created":1587634232391,"text":"会直接添加到数据库，不用再进行save()","expandState":"expand","layout":null},"children":[]}]}]}]}]},{"data":{"id":"c28hee1rf8o0","created":1587634329188,"text":"启动服务器","layout":null,"expandState":"collapse","progress":null},"children":[{"data":{"id":"c28her5ock00","created":1587634357723,"text":"格式","layout":null},"children":[{"data":{"id":"c28hesu7ctk0","created":1587634361383,"text":"python manage.py runserver ip:port","layout":null},"children":[]},{"data":{"id":"c28hey1icsw0","created":1587634372709,"text":"ip不写代表本机ip","layout":null},"children":[]},{"data":{"id":"c28hf4bo8200","created":1587634386384,"text":"port不写默认是8000","layout":null},"children":[]}]},{"data":{"id":"c28hfd5k9u00","created":1587634405606,"text":"说明","layout":null},"children":[{"data":{"id":"c28hfegmf6o0","created":1587634408451,"text":"Python写的轻量级web服务器，仅在开发测试时使用","layout":null},"children":[]}]},{"data":{"id":"c28hfoh1wrc0","created":1587634430245,"text":"启动","layout":null},"children":[{"data":{"id":"c28hfrge99c0","created":1587634436736,"text":"打开终端没进入项目目录","layout":null},"children":[]},{"data":{"id":"c28hfxuiwfs0","created":1587634450651,"text":"python manage.py runserver","layout":null},"children":[]},{"data":{"id":"c28hg2zw35c0","created":1587634461859,"text":"别忘了启动数据库","layout":null},"children":[]},{"data":{"id":"c28hg93l6tc0","created":1587634475143,"text":"浏览器输入  127.0.0.1:8000检查","layout":null},"children":[]}]},{"data":{"id":"c28hfqcuxfk0","created":1587634434345,"text":"分支主题","layout":null},"children":[]}]},{"data":{"id":"c28hgnhlk600","created":1587634506465,"text":"Admin站点管理","layout":null,"expandState":"collapse","progress":null},"children":[{"data":{"id":"c28hh713lkw0","created":1587634549003,"text":"更好的管理数据库的数据，相当于一个后台管理系统","layout":null},"children":[]},{"data":{"id":"c28hgrf6e2o0","created":1587634515026,"text":"概述","layout":null},"children":[{"data":{"id":"c28hgw0mq8w0","created":1587634525030,"text":"内容发布","layout":null},"children":[{"data":{"id":"c28hgxre7js0","created":1587634528826,"text":"负责添加、修改、删除数据","layout":null},"children":[]}]},{"data":{"id":"c28hhkb8fxk0","created":1587634577914,"text":"公告访问","layout":null},"children":[]}]},{"data":{"id":"c28hhnvn4w00","created":1587634585679,"text":"配置Admin应用","layout":null,"expandState":"collapse"},"children":[{"data":{"id":"c28hhzmr1yo0","created":1587634611262,"text":"在settings.py中的INSTALLED_APPS中添加django.contrib.admin","layout":null},"children":[{"data":{"id":"c28hihzacu80","created":1587634651203,"text":"默认已经添加","layout":null},"children":[]}]}]},{"data":{"id":"c28hio3tgo00","created":1587634664537,"text":"创建管理员用户","expandState":"collapse","layout":null},"children":[{"data":{"id":"c28hj1d856w0","created":1587634693404,"text":"python manage.py createsuperuser","layout":null},"children":[]},{"data":{"id":"c28hjomaggw0","created":1587634744018,"text":"输入账号密码","layout":null},"children":[]},{"data":{"id":"c28hjv6o8f40","created":1587634758311,"text":"浏览器127.0.0.1:8000/admin进入","layout":null},"children":[]}]},{"data":{"id":"c28hk6fsl6o0","created":1587634782808,"text":"汉化","expandState":"collapse","layout":null},"children":[{"data":{"id":"c28hk84gyvs0","created":1587634786477,"text":"settings.py文件","expandState":"expand","layout":null},"children":[{"data":{"id":"c28hkcznreo0","created":1587634797070,"text":"LANGUAGE_CODE = 'zh-Hans'\n\nTIME_ZONE = 'Asia/Shanghai'","layout":null},"children":[]}]}]},{"data":{"id":"c28hl0b57480","created":1587634847830,"text":"管理数据表","layout":null},"children":[{"data":{"id":"c28hl2e4cnk0","created":1587634852363,"text":"修改admin.py文件","expandState":"collapse","layout":null},"children":[{"data":{"id":"c28hlzwynxk0","created":1587634925337,"text":"引入models中的类","layout":null},"children":[{"data":{"id":"c28hm3hcfc80","created":1587634933099,"text":"from .models import Grades, Students","layout":null},"children":[]}]},{"data":{"id":"c28hmi404dk0","created":1587634964944,"text":"添加注册","layout":null},"children":[{"data":{"id":"c28hmjlpqmw0","created":1587634968192,"text":"admin.site.register(Grades)\nadmin.site.register(Students)","layout":null},"children":[]}]}]},{"data":{"id":"c28hncbgpog0","created":1587635030699,"text":"自定义管理页面","color":"#ff0000","expandState":"collapse","layout":null},"children":[{"data":{"id":"c28hnxfvmjk0","created":1587635076678,"text":"定义类class GradesAdmin(admin.ModelAdmin):","layout":null},"children":[]},{"data":{"id":"c28ho5828cg0","created":1587635093620,"text":"列表页属性","expandState":"expand","color":"#ffc000","layout":null},"children":[{"data":{"id":"c28hoakwbdc0","created":1587635105280,"text":"list_display = ['pk', 'name', 'date', 'girl_num', 'boy_num', 'isDelete']","layout":null},"children":[{"data":{"id":"c28hq5l8s000","created":1587635251145,"text":"修改页面显示的字段","layout":null},"children":[]}]},{"data":{"id":"c28hp4n9ngw0","created":1587635170727,"text":"list_filter = ['name']","layout":null},"children":[{"data":{"id":"c28hqffn6c80","created":1587635272575,"text":"过滤器，在页面右侧","layout":null},"children":[]}]},{"data":{"id":"c28hp80oty80","created":1587635178069,"text":"search_fields = ['name']","layout":null},"children":[{"data":{"id":"c28hr1g5khc0","created":1587635320495,"text":"搜索框","layout":null},"children":[]}]},{"data":{"id":"c28hpbc0xbc0","created":1587635185284,"text":"list_per_page = 5","layout":null},"children":[{"data":{"id":"c28hr9bjayg0","created":1587635337630,"text":"每页最多显示多少条数据","layout":null},"children":[]}]}]},{"data":{"id":"c28hocj2v940","created":1587635109524,"text":"添加、修改页属性","expandState":"expand","color":"#ffc000","layout":null},"children":[{"data":{"id":"c28hofi4st40","created":1587635115997,"text":"fields = ['girl_num', 'boy_num', 'name', 'date', 'isDelete']","layout":null},"children":[{"data":{"id":"c28hrx2w0g00","created":1587635389350,"text":"规定属性的先后顺序","layout":null},"children":[]}]},{"data":{"id":"c28hrnmpuqg0","created":1587635368781,"text":"fieldsets = [\n('num', {'fields': ['girl_num', 'boy_num']}),\n('base', {'fields': ['name', 'date', 'isDelete']}),\n]","layout":null},"children":[{"data":{"id":"c28hsdvfj600","created":1587635425904,"text":"给属性分组","layout":null},"children":[]}]},{"data":{"id":"c28hsjfvaeg0","created":1587635438024,"text":"注意：fields和fieldsets不能同时使用","layout":null},"children":[]}]},{"data":{"id":"c28jpy4o2mo0","created":1587640877125,"text":"关联对象","layout":null},"children":[{"data":{"id":"c28jqhivg480","created":1587640919343,"text":"需求：在创建一个班级的时候可以同时添加几个学生","layout":null},"children":[{"data":{"id":"c28jtx2tfmo0","created":1587641188293,"text":"class StudentsInfo(admin.TabularInline):","layout":null},"children":[{"data":{"id":"c28ju4b96iw0","created":1587641204041,"text":"model = Students","layout":null},"children":[]},{"data":{"id":"c28ju4bah5s0","created":1587641204043,"text":"extra = 0","layout":null},"children":[]}]},{"data":{"id":"c28juybeqt40","created":1587641269354,"text":"class StudentsInfo(admin.StackedInline):","layout":null},"children":[{"data":{"id":"c28jv5tv0880","created":1587641285707,"text":"和上一个排版不一样","layout":null},"children":[]}]},{"data":{"id":"c28juhjtv5s0","created":1587641232858,"text":"class GradesAdmin(admin.ModelAdmin):","layout":null},"children":[{"data":{"id":"c28jurdcj3s0","created":1587641254234,"text":"inlines = [StudentsInfo]","layout":null},"children":[]}]}]}]},{"data":{"id":"c28jvpyad5s0","created":1587641329510,"text":"布尔值显示问题","expandState":"expand","layout":null},"children":[{"data":{"id":"c28jw7m8ud40","created":1587641367964,"text":"写函数","layout":null},"children":[]},{"data":{"id":"c28jw1jmtps0","created":1587641354746,"text":"def sex(self):\n\tif self.gender:\n\t    return '男'\n\telse:\n\t    return '女'\n# 设置页面列的名称\nsex.short_description = '性别'\nlist_display = ['pk', 'name', 'age', sex, 'contend', 'grade', 'isDelete']","layout":null},"children":[]}]},{"data":{"id":"c28jx06wxq00","created":1587641430164,"text":"执行动作的位置问题","expandState":"expand","layout":null},"children":[{"data":{"id":"c28jxjlvfw80","created":1587641472427,"text":"actions_on_bottom = True\nactions_on_top = False","layout":null},"children":[]}]},{"data":{"id":"c28jxiuy9cg0","created":1587641470799,"text":"使用装饰器完成注册","expandState":"expand","layout":null},"children":[{"data":{"id":"c28jycdbubc0","created":1587641535037,"text":"@admin.register(Students)\nclass StudentsAdmin(admin.ModelAdmin):","layout":null},"children":[]}]},{"data":{"id":"c28jybh6vqo0","created":1587641533094,"text":"分支主题","layout":null},"children":[]}]}]}]},{"data":{"id":"c28hgq99dw00","created":1587634512492,"text":"视图的基本使用","expandState":"collapse","layout":null,"progress":null},"children":[{"data":{"id":"c28jzd13ylk0","created":1587641614839,"text":"概述","expandState":"collapse","layout":null},"children":[{"data":{"id":"c28jzeh6cw80","created":1587641617988,"text":"在django中，视图对web请求进行回应","layout":null},"children":[]},{"data":{"id":"c28jzl4dkio0","created":1587641632451,"text":"视图就是一个Python函数， 在views.py文件中定义","layout":null},"children":[]}]},{"data":{"id":"c28k0mb0eoo0","created":1587641713393,"text":"定义视图","expandState":"collapse","layout":null},"children":[{"data":{"id":"c28k0ui82lk0","created":1587641731244,"text":"from django.http import HttpResponse","layout":null},"children":[]},{"data":{"id":"c28k1pmpbs00","created":1587641798995,"text":"def index(request):","layout":null},"children":[{"data":{"id":"c28k1q70m8o0","created":1587641800223,"text":"return HttpResponse('zcz is a goood boy. ')","layout":null},"children":[]}]}]},{"data":{"id":"c28k0tlm4lk0","created":1587641729273,"text":"配置url","expandState":"collapse","layout":null},"children":[{"data":{"id":"c28k1ypg66o0","created":1587641818752,"text":"修改project目录下的urls.py文件","expandState":"expand","layout":null},"children":[{"data":{"id":"c28k41pr97k0","created":1587641982029,"text":"from django.conf.urls import url, include\nfrom django.contrib import admin\n\n\nurlpatterns = [\n\turl(r'^admin/', admin.site.urls),\n\turl(r'^', include('myApp.urls')),\n\n]","layout":null},"children":[]}]},{"data":{"id":"c28k2q3bzj40","created":1587641878365,"text":"在myApp应用目录下创建一个urls.py文件","expandState":"expand","layout":null},"children":[{"data":{"id":"c28k4bjgfjc0","created":1587642003416,"text":"from django.conf.urls import url\n\nfrom . import views\n\nurlpatterns = [\n\turl(r'^$', views.index),\n\turl(r'^(\\d+)/$', views.detail),\n\turl(r'^grades/$', views.grades),\n\turl(r'^students/$', views.students),\n\turl(r'^grades/(\\d+)/$', views.get_student_id),\n]","layout":null},"children":[]}]}]}]},{"data":{"id":"c28k6did5lk0","created":1587642164432,"text":"模板的基本使用","expandState":"collapse","layout":null,"progress":null},"children":[{"data":{"id":"c28k6fzziy80","created":1587642169851,"text":"概述","layout":null},"children":[{"data":{"id":"c28k6hab9zc0","created":1587642172652,"text":"模板就是HTML页面，可以根据视图传过来的数据对页面进行填充","layout":null},"children":[]}]},{"data":{"id":"c28k6sg4e280","created":1587642196948,"text":"创建模板","layout":null},"children":[{"data":{"id":"c28k73d7e7c0","created":1587642220716,"text":"新建templates文件夹","layout":null},"children":[{"data":{"id":"c28k7h3n8ig0","created":1587642250613,"text":"在templates中新建myApp文件夹","layout":null},"children":[]}]}]},{"data":{"id":"c28k83oypq00","created":1587642299791,"text":"配置模板路径","layout":null},"children":[{"data":{"id":"c28k8ar1y5k0","created":1587642315155,"text":"修改settings.py文件下的TEMPLATES","layout":null},"children":[{"data":{"id":"c28k90qf2qw0","created":1587642371713,"text":"'DIRS': [os.path.join(BASE_DIR, 'templates')],","layout":null},"children":[]}]}]},{"data":{"id":"c28k9s8xfqg0","created":1587642431606,"text":"定义grades.html和students.html模板","expandState":"collapse","layout":null},"children":[{"data":{"id":"c28ka9g4jzk0","created":1587642469046,"text":"模板语法","expandState":"expand","layout":null},"children":[{"data":{"id":"c28kab7l0u00","created":1587642472883,"text":"{{ 输出值，可以使变量，可以使对象.属性 }}","layout":null},"children":[]},{"data":{"id":"c28kamvvt0w0","created":1587642498297,"text":"{% 执行代码 %}","layout":null},"children":[]}]}]},{"data":{"id":"c28kc86fwn40","created":1587642623012,"text":"http://127.0.0.1:8000/grades","expandState":"collapse","layout":null},"children":[{"data":{"id":"c28kdc9eeog0","created":1587642710262,"text":"写grades.html模板","layout":null},"children":[{"data":{"id":"c28kaw2822w0","created":1587642518271,"text":"{% for grade in grades %}\n<li>\n\t<a href=\"#\">{{ grade.name }}</a>\n</li>\n{% endfor %}","layout":null},"children":[]}]},{"data":{"id":"c28kcwaf5g00","created":1587642675495,"text":"定义视图 ","layout":null,"expandState":"expand"},"children":[{"data":{"id":"c28novgnyx40","created":1587652077396,"text":"from .models import Grades, Students\ndef grades(request):\n\t# 去模型里取数据\n\tgrades_list = Grades.objects.all()\n\t# 将数据传递给模板， 模板再渲染页面， 将渲染好的页面返回给浏览器\n\treturn render(request, 'myApp/grades.html', {'grades': grades_list})","layout":null},"children":[]}]},{"data":{"id":"c28kcwaf5g00","created":1587642675495,"text":"配置URL ","layout":null},"children":[{"data":{"id":"c28npdg8d4w0","created":1587652116552,"text":"url(r'^grades/$', views.grades),","layout":null},"children":[]}]},{"data":{"id":"c28nq0kincw0","created":1587652166877,"text":"说明：代码只有部分，全代码仍需要去看视频","layout":null},"children":[]},{"data":{"id":"c28nqhsxkzc0","created":1587652204391,"text":"流程总结","layout":null},"children":[{"data":{"id":"c28nqpgb5i00","created":1587652221042,"text":"写模板，也就是HTML页面","layout":null},"children":[]},{"data":{"id":"c28nqyi0zjk0","created":1587652240737,"text":"页面要与数据库交互，因此要定义视图","layout":null},"children":[]},{"data":{"id":"c28nseqtqqw0","created":1587652354462,"text":"视图负责去模型中取得相应的数据（因为模型负责和数据库对接，所以要拿数据库的数据必须经过模型）","layout":null},"children":[]},{"data":{"id":"c28nsviebu80","created":1587652390957,"text":"视图在模型中取得了相应的数据，再返回给模板渲染","layout":null},"children":[]}]}]},{"data":{"id":"c28nvqagqzk0","created":1587652614687,"text":"点击班级，显示对应班级的所有学生","layout":null},"children":[{"data":{"id":"c28nvun6q340","created":1587652624163,"text":"定义视图","layout":null},"children":[{"data":{"id":"c28nvwf9xb40","created":1587652628038,"text":"def get_student_id(request, num):","layout":null},"children":[{"data":{"id":"c28nw2lcgaw0","created":1587652641466,"text":"grade = Grades.objects.get(pk=num)","layout":null},"children":[{"data":{"id":"c28nwaltbao0","created":1587652658908,"text":"获得对应的班级对象","layout":null},"children":[]}]},{"data":{"id":"c28nw2lck480","created":1587652641466,"text":"student_list = grade.students_set.all()","layout":null},"children":[{"data":{"id":"c28nwed8nwo0","created":1587652667097,"text":"获得该班级的学生列表","layout":null},"children":[]}]},{"data":{"id":"c28nw2ldcl40","created":1587652641467,"text":"return render(request, 'myApp/students.html', {'students': student_list})","layout":null},"children":[]}]}]},{"data":{"id":"c28ny2g8kzc0","created":1587652797885,"text":"配置url","layout":null},"children":[{"data":{"id":"c28ny4h1a540","created":1587652802287,"text":"url(r'^grades/(\\d+)/$', views.get_student_id),","layout":null},"children":[]}]},{"data":{"id":"c28nyhi06fc0","created":1587652830644,"text":"流程解析","layout":null},"children":[{"data":{"id":"c28nyk932e80","created":1587652836635,"text":"点击grades.html页面的超链接，观察地址栏，可以看到会返回类似于localhost:8000/grades/1的地址，所以需要配置相应的url","layout":null},"children":[]},{"data":{"id":"c28o05a2n080","created":1587652960771,"text":"而数据的处理需要交给views层，所以需要定义相对应的视图","layout":null},"children":[]},{"data":{"id":"c28o2k5o2sg0","created":1587653149886,"text":"需要注意，虽然地址栏是grades/1，但是显示的是students.html的内容，原因是视图返回了myApp/students.html以及相对应的学生列表","layout":null},"children":[]}]},{"data":{"id":"c28nyp7cqqg0","created":1587652847414,"text":"说明：代码仍旧不全，全代码还请去看视频","layout":null},"children":[]}]}]},{"data":{"id":"c29ceh5qvtk0","created":1587721790367,"text":"流程梳理","expandState":"collapse"},"children":[{"data":{"id":"c29cer3o6g00","created":1587721812009,"text":"创建工程"},"children":[{"data":{"id":"c29cet4mk2o0","created":1587721816420,"text":"执行   dijango-admin startproject project"},"children":[]}]},{"data":{"id":"c29cf0sjdfs0","created":1587721833104,"text":"创建项目"},"children":[{"data":{"id":"c29cf2jjsy00","created":1587721836914,"text":"执行  python manage.py startapp myApp"},"children":[]}]},{"data":{"id":"c29cf8rj2s00","created":1587721850457,"text":"激活项目"},"children":[{"data":{"id":"c29cfao0ddc0","created":1587721854598,"text":"修改 settings.py中的INSTALLED_APPS"},"children":[]}]},{"data":{"id":"c29cfk449gg0","created":1587721875163,"text":"配置数据库"},"children":[{"data":{"id":"c29cfnoxahs0","created":1587721882951,"text":"修改__init__.py,引入pymysql包"},"children":[]},{"data":{"id":"c29cfxahoh40","created":1587721903846,"text":"修改settings.py文件中的DATABASES"},"children":[]}]},{"data":{"id":"c29cg1ysfvk0","created":1587721914023,"text":"创建模型类"},"children":[{"data":{"id":"c29cg4ud1b40","created":1587721920285,"text":"在项目目录下的models.py文件中"},"children":[]}]},{"data":{"id":"c29cg9jbu1s0","created":1587721930502,"text":"生成迁移文件"},"children":[{"data":{"id":"c29cgny8l7k0","created":1587721961879,"text":"执行 python manage.py makemigrations"},"children":[]}]},{"data":{"id":"c29cgtwtnao0","created":1587721974854,"text":"执行迁移"},"children":[{"data":{"id":"c29cgvn4s3k0","created":1587721978621,"text":"执行  python manage.py migrate"},"children":[]}]},{"data":{"id":"c29chpem8w00","created":1587722043410,"text":"配置ADMIN站点"},"children":[]},{"data":{"id":"c29cicv3pq00","created":1587722094473,"text":"创建模板目录/项目模板目录"},"children":[]},{"data":{"id":"c29ck4omxyw0","created":1587722233396,"text":"在settings.py文件的TEMPLATES中配置模板路径"},"children":[]},{"data":{"id":"c29cj4bdf140","created":1587722154230,"text":"在project下修改urls.py"},"children":[]},{"data":{"id":"c29cj9fhq0g0","created":1587722165363,"text":"在项目目录下创建urls.py"},"children":[]}]}]},"template":"right","theme":"snow-compact","version":"1.4.43"}